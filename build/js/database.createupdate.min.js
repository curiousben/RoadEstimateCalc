/*
*
* DISCLAIMER:
* The contents of this web application do not nessarily reflect the offical 
* views or policies of the Virginia Department of Transportation, the 
* Commonwealth Transportation Board, or the Federal Highway Administration.
* This web app does not constitue a standard, specification, or regulation.
* Any inclusion of manufacturer names, trade names, or trademarksis for 
* identification purposes only and is not to be considered an endorsement.
*
*/

/* RoadEstimateCalc v0.2.2 | 2015 Virginia Transportation Research Council */
function TimeStamp(){var a,b=new Date,c=["January","February","March","April","May","June","July","August","September","October","November","December"],d=b.getDate(),e=b.getMonth(),f=b.getFullYear(),g=b.getHours(),h=b.getMinutes();return 12>g?a="AM":(a="PM",g-=12),c[e]+" "+d+", "+f+"  "+g+":"+h+" "+a}function CreateRecordChoice(){sessionStorage.setItem("Recordchoice",1),ChoiceLoader(),document.getElementsByName("CreateCTime")[0].value=TimeStamp(),document.getElementsByName("CreateUTime")[0].value=TimeStamp(),document.getElementsByName("CreateDataArray")[0].value=JSON.stringify(DataArrayObject())}function UpdateRecordChoice(){sessionStorage.setItem("Recordchoice",2),ChoiceLoader(),document.getElementsByName("UpdateTimeStamp")[0].value=TimeStamp(),document.getElementsByName("UpdateDataArray")[0].value=JSON.stringify(DataArrayObject())}function ChoiceLoader(){windowdown=sessionStorage.getItem("Recordchoice"),1==windowdown&&($("#UpdateRecordForm").toggle(!1),$("#CreateRecordForm").toggle("swing")),2==windowdown&&($("#UpdateRecordForm").toggle("swing"),$("#CreateRecordForm").toggle(!1))}function LastImportedRecordInfo(){document.getElementsByName("UpdateEstimator")[0].value=localStorage.getItem("ImportEstimator"),document.getElementsByName("UpdateUPC")[0].value=localStorage.getItem("ImportUPC"),document.getElementsByName("UpdateRoadNumber")[0].value=localStorage.getItem("ImportRoadNumber")}function CreateAJAXCall(){var a=document.getElementsByName("CreateEstimator")[0].value,b=document.getElementsByName("CreateUPC")[0].value,c=document.getElementsByName("CreateRoadNumber")[0].value,d=document.getElementsByName("CreateCTime")[0].value,e=document.getElementsByName("CreateUTime")[0].value,f=document.getElementsByName("CreateDataArray")[0].value;$.ajax({async:!1,url:"/datarecords",type:"POST",dataType:"application/json",data:{CreateEstimator:""+a,CreateUPC:""+b,CreateRoadNumber:""+c,CreateCTime:""+d,CreateUTime:""+e,CreateDataArray:""+f}}).done(function(){console.log("success")}).fail(function(){console.log("error")}).always(function(){console.log("complete")}),localStorage.setItem("ImportEstimator",a),localStorage.setItem("ImportUPC",b),localStorage.setItem("ImportRoadNumber",c)}function UpdateAJAXCall(a){var b=document.getElementsByName("UpdateEstimator")[0].value,c=document.getElementsByName("UpdateUPC")[0].value,d=document.getElementsByName("UpdateRoadNumber")[0].value,e=document.getElementsByName("UpdateTimeStamp")[0].value,f=document.getElementsByName("UpdateDataArray")[0].value;$.ajax({async:!1,url:"/datarecords/Estimator="+b+"&&UPC="+c+"&&RoadNumber="+d,type:"PUT",dataType:"application/json",data:{UpdateTimeStamp:""+e,UpdateDataArray:""+f}}).done(function(){alert("success")}).fail(function(){console.log("error")}).always(function(){console.log("complete")})}function DataArrayObject(){DataArray={};for(var a=localStorage.length-1;a>=0;a--){var b=localStorage.key(a);("ImportEstimator"!=b||"ImportUPC"!=b||"ImportRoadNumber"!=b)&&(Data=localStorage.getItem(localStorage.key(a)),DataArray[b]=Data)}return DataArray}$(document).ready(function(){ChoiceLoader(),$("#CreateFormButton").click(CreateRecordChoice),$("#UpdateFormButton").click(UpdateRecordChoice),$("#LastImportInfo").click(LastImportedRecordInfo),$("#CreateForm").submit(CreateAJAXCall),$("#UpdateForm").submit(UpdateAJAXCall),$("form").submit(function(a){var b=$(this).find("[required]");return $(b).each(function(){return""==$(this).val()?(alert("Please fill in "),$(this).focus(),a.preventDefault(),!1):void 0}),!0})});