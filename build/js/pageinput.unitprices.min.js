/*
*
* DISCLAIMER:
* The contents of this web application do not nessarily reflect the offical 
* views or policies of the Virginia Department of Transportation, the 
* Commonwealth Transportation Board, or the Federal Highway Administration.
* This web app does not constitue a standard, specification, or regulation.
* Any inclusion of manufacturer names, trade names, or trademarksis for 
* identification purposes only and is not to be considered an endorsement.
*
*/

/* RoadEstimateCalc v0.2.2 | 2015 Virginia Transportation Research Council */
function numberleftblank(a){return a?a:1}function UnitPricesSlider(){$("#pcei").slider({value:numberleftblank(localStorage.getItem("pcei")),min:1,max:100,slide:function(a,b){$("#pceiinput").val(b.value),localStorage.setItem("pcei",b.value)}}),$("#pceiinput").change(function(a){localStorage.setItem("pcei",$(this).val()),$("#pcei").slider("option","value",$(this).val())}),$("#pceiinput").val($("#pcei").slider("value"))}function RegionalPrices(){var a=[];switch($("#Road_Estimate_Tool input").each(function(){a.push($(this).attr("id"))}),document.getElementById("choice").value){case"BristolSalemLynchburgStauntonCulpepper":for(var b=[2e4,17,15,17,20,40,125,250,300,4e3,35,110,100,90,20,25,400,2e3,5e3,1e4,2e3,90,15,4,500,75,3e5,0,25,2500,2e3,300,18,700,75e3],c=a.length-1;c>=0;c--)localStorage.setItem(a[c],b[c]),document.getElementById(a[c]).value=b[c];localStorage.setItem("pcei",20),$("#pcei").slider("option","value",20),$("#pceiinput").val($("#pcei").slider("value"));break;case"NOVA":for(var d=[2e4,17,15,17,20,40,125,250,300,4e3,35,110,100,90,20,25,400,2e3,5e3,1e4,2e3,90,15,4,500,75,3e5,0,25,2500,2e3,300,18,700,75e3],c=a.length-1;c>=0;c--)localStorage.setItem(a[c],d[c]),document.getElementById(a[c]).value=d[c];localStorage.setItem("pcei",20),$("#pcei").slider("option","value",20),$("#pceiinput").val($("#pcei").slider("value"));break;case"HamptonRoads":for(var e=[2e4,17,15,17,20,40,125,250,300,4e3,35,110,100,90,20,25,400,2e3,5e3,1e4,2e3,90,15,4,500,75,3e5,0,25,2500,2e3,300,18,700,75e3],c=a.length-1;c>=0;c--)localStorage.setItem(a[c],e[c]),document.getElementById(a[c]).value=e[c];localStorage.setItem("pcei",20),$("#pcei").slider("option","value",20),$("#pceiinput").val($("#pcei").slider("value"));break;case"FredericksburgRichmond":districtfour=[2e4,17,15,17,20,40,125,250,300,4e3,35,110,100,90,20,25,400,2e3,5e3,1e4,2e3,90,15,4,500,75,3e5,0,25,2500,2e3,300,18,700,75e3];for(var c=a.length-1;c>=0;c--)localStorage.setItem(a[c],districtfour[c]),document.getElementById(a[c]).value=districtfour[c];localStorage.setItem("pcei",20),$("#pcei").slider("option","value",20),$("#pceiinput").val($("#pcei").slider("value"))}}function basicinputmemory(){localStorage.setItem(this.id,this.value)}function checkboxmemory(){var a,b;b=$(this).prop("id").slice(-1),options=$(this).prop("id").slice(0,1),localStorage.setItem($(this).prop("id"),$(this).prop("checked")),$('#Road_Estimate_Tool input[type="checkbox"]').not(this).prop("checked",function(){$(this).prop("checked")&&(a=$(this).prop("id").slice(-1)),$(this).prop("checked",!1),localStorage.setItem($(this).prop("id"),!1)}),checkboxhide(b,a)}function checkboxhide(a,b){if(b)for(;b>=1;)$("#checkbox"+b).toggle(!1),b--;for(;a>=1;)$("#checkbox"+a).toggle("swing"),a--}function expandTextarea(a){var b=$(".misclass").get(a);b.addEventListener("keyup",function(){this.style.overflow="hidden",this.style.height=0,this.style.height=this.scrollHeight+"px"},!1)}function CurrentlyloadedRecord(){if(null!=localStorage.getItem("ImportEstimator")||null!=localStorage.getItem("ImportUPC")||null!=localStorage.getItem("ImportRoadNumber")){$("#LoadedRecord").removeClass("hide"),document.getElementById("RecordEstimator").innerHTML=localStorage.getItem("ImportEstimator"),document.getElementById("RecordUPC").innerHTML=localStorage.getItem("ImportUPC"),document.getElementById("RecordRoadNumber").innerHTML=localStorage.getItem("ImportRoadNumber");for(var a,b=!0,c=$(document)[0].URL,d=c.length-1;d>=0;d--)"/"==c.charAt(d)&&1==b&&(a=c.slice(d,c.length),b=!1);localStorage.setItem("lastURL",a)}}function ReceiptLink(){window.location="http://localhost:3000/Receipt"}function ImportCurrentlyLoadedRecord(){Estimator=localStorage.getItem("ImportEstimator"),UPC=localStorage.getItem("ImportUPC"),RoadNumber=localStorage.getItem("ImportRoadNumber"),$.getJSON("/datarecords/Estimator&&UPC&&RoadNumber/"+Estimator+"&&"+UPC+"&&"+RoadNumber,function(a){DataArrayObject=$.parseJSON(a[0].DataArray),localStorage.clear();for(var b in DataArrayObject)localStorage.setItem(b,DataArrayObject[b]);localStorage.setItem("ImportEstimator",a[0].Estimator),localStorage.setItem("ImportUPC",a[0].UPC),localStorage.setItem("ImportRoadNumber",a[0].RoadNumber),PageRefreshAddons();for(var c,d=!0,e=$(document)[0].URL,b=e.length-1;b>=0;b--)"/"==e.charAt(b)&&1==d&&(c=e.slice(b,e.length),d=!1);localStorage.setItem("lastURL",c)})}function Addons(){"function"==typeof ProposedRoadwaySliders&&ProposedRoadwaySliders(),"function"==typeof UnitPricesSlider&&(UnitPricesSlider(),$("#regionreset").click(RegionalPrices))}function PageRefreshAddons(a){"function"==typeof ProposedRoadwaySliders&&(Pageload(),ProposedRoadwaySliders()),"function"==typeof UnitPricesSlider&&(UnitPricesSlider(),Pageload()),Pageload()}function Pageload(){var a=$.contains(document.body,$("#Road_Estimate_Tool input")[0]),b=$.contains(document.body,$("#Road_Estimate_Tool select")[0]),c=$.contains(document.body,$("#Road_Estimate_Tool textarea")[0]);if(a){var d=[],e=[];$("#Road_Estimate_Tool input").each(function(){"checkbox"==$(this).attr("type")&&e.push($(this).attr("id")),d.push($(this).attr("id"))});for(var f=d.length-1;f>=0;f--)null!=localStorage.getItem(d[f])?(jQuery.inArray(d[f],e)>=0&&("true"==localStorage.getItem(d[f])?(document.getElementById(d[f]).checked=!0,checkboxhide(d[f].slice(-1),!1)):document.getElementById(d[f]).checked=!1),document.getElementById(d[f]).value=localStorage.getItem(d[f])):document.getElementById(d[f]).value=null}if(b){var g=[];$("#Road_Estimate_Tool select").each(function(){g.push($(this).attr("id"))});for(var f=g.length-1;f>=0;f--)null!=localStorage.getItem(g[f])?$("#"+g[f]).val(localStorage.getItem(g[f])):document.getElementById(g[f]).selectedIndex=0}if(c){var h=[];$("#Road_Estimate_Tool textarea").each(function(){h.push($(this).attr("id"))}),expandTextarea(h.length-1);for(var f=h.length-1;f>=0;f--)null!=localStorage.getItem(h[f])?document.getElementById(h[f]).value=localStorage.getItem(h[f]):document.getElementById(h[f]).value=null}}$(document).ready(function(){CurrentlyloadedRecord(),Pageload(),Addons(),$("#Road_Estimate_Tool input").bind("keyup mouseup",basicinputmemory),$("#Road_Estimate_Tool textarea").bind("keyup mouseup",basicinputmemory),$("#Road_Estimate_Tool select").bind("change",function(){localStorage.setItem(this.id,this.options[this.selectedIndex].value)}),$('#Road_Estimate_Tool input[type="checkbox"]').on("change",checkboxmemory),$("#ReceiptOfLoaded").click(ReceiptLink),$("#ImportLastloaded").click(ImportCurrentlyLoadedRecord)});